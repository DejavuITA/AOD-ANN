\chapter{Samples, setup and experiments}
\label{ch:experiments}

All the experiments have been carried out on \acs{PIC} developed within a FP7 project (IRIS, \cite{testa2016design}) that aimed to develop an optical router.
An optical router is a matrix of microresonators whose resonances are tuned at will to (re)direct an optical signal along a predefined path.
We exploit the nonlinear optical response of these nodes to demonstrate the feasibility of an all optical nonlinear activation function made on PIC.

%All the experiments have been carried out on samples manufactured for the IRIS project \cite{testa2016design}.
%This is due to the fact that in the time frame of this work there would have not been enough time to design and produce an ad hoc device.
%Moreover, as already stated, the aim of this thesis is to produce a proof of concept for an all-optical implementation of an activation function, rather than to construct a complete prototype.
%With the knowledge obtained during this work, future researches could design new structures by focusing on the correct parameters.

\section{The samples}
The IRIS project studied the design and the implementation of an integrated reconfigurable silicon photonics switch matrix, a routing device, as a replacement for electronic devices used in the telecommunication industry.
The completed integrated photonic circuit consists of a matrix of waveguides crossing each other and linked by couples of racetrack resonators, thermally-controlled.
At the ends of the waveguides other structures, interleavers and \acsp{AWG}, allowed many signals at different wavelengths to be multiplexed/demultiplexed onto/from the same waveguide.

\begin{figure}[hbtp]
	\centering
	\input{tikz/IRIS.tex}
	\caption{Scheme of a routing node of the full \acs{PIC} of IRIS. $\lambda_0$ travels from the input port to the through port; $\lambda_5$ is redirected from the input port to the drop port; $\lambda_3$ is redirected from an add port to the through port.}
	\label{fig:fullmatrix}
\end{figure}

Each node of the matrix can be modeled by a microring resonator in \acs{ADF} configuration (see \autoref{ssec:Microring_optical_cavity}).
Any signal that enters a node detuned from the resonance of the microring is directed toward the through port of the node.
On the other hand, any signal that enters a node in resonance with the microring is redirected toward the drop port.
\autoref{fig:fullmatrix} shows the scheme of a node in the full \acs{PIC}, where the signals is routed.

%The complexity of such photonic circuit required outstanding precision in the design and the fabrication.
%Hence, for preliminary testing purposes, each and every structure of which the full device is composed, has been manufactured repeatedly with several small variations.
%For example, several microrings in the \ac{ADF} configuration have been fabricated with different radius, or different ring-waveguide gap.
%The collection of all these testing structures on the same chip was produced in a few samples.
%All these test structures as well as a fully completed switch matrix were disposed on a single chip, accessible via grating couplers.

\newpage
The development of the final IRIS chip has required several steps of improvement and few generation of test samples were fabricated with different optical properties.
Thus the first step of the thesis has been to choose, among the many different devices available, the most promising ones.
%characterize qualitatively the response of some devices among the single structures, the short sequences of structures, and the full switch matrix itself.
%After many trials of different devices, my final choice was to study a system of intermediate complexity.
%In fact, since the work in this thesis is like the first step in a long journey, with this choice I tried to obtain a compromise between simplicity in immediate future (current work) and adaptability in the long term.
%For example, the current structure allowed me to study the nonlinear activation function, but could be reused in the future to study the weighted sum.
The structure selected (nicknamed \textit{mini-matrix}) is shown in \autoref{fig:photos} and it is composed by: a waveguide, coupled to eight drop channels through ring resonators.
In this family of devices, there were mini-matrices built with single microrings, double microrings, single racetracks, or double racetracks.
%The final choice was to study the \textit{mini-matrix} in which the coupling mechanism was provided by single ring resonators, because of its simpler transfer function in respect to double microrings or double racetracks.
\autoref{fig:minimatrix_scheme} shows a simplified scheme of the \textit{mini-matrix}.

\begin{figure}[htbp]
	\centering
	\begin{subfigure}[b]{0.7\textwidth}
		\centering
		\includegraphics[width=\textwidth]{photos/minimatrix.png}
		\caption{mini-matrix}
		\label{fig:photo_minimatrix}
	\end{subfigure}
	\begin{subfigure}[t]{0.345\textwidth}
		\centering
		\includegraphics[width=\textwidth]{photos/ring.png}
		\caption{microring}
		\label{fig:photo_ring}
	\end{subfigure}
	\begin{subfigure}[t]{0.345\textwidth}
		\centering
		\includegraphics[width=\textwidth]{photos/grating.png}
		\caption{grating}
		\label{fig:photo_grating}
	\end{subfigure}
	\caption{Magnified photograph of the \textit{mini-matrix} device chosen (a) and two important structures: (b) microring resonator and (c) output grating couplers. }
	\label{fig:photos}
\end{figure}

\begin{figure}[hbtp]
	\centering
%	\includegraphics[scale=.4]{figures/miniMATRIX_Klayout.png}\\
	\input{tikz/miniMATRIX_scheme.tex}
	\caption{
		Simplified scheme of the \textit{mini-matrix} integrated photonic circuit (structures are not in scale).
		Triangles (orange) are the grating couplers ($in$, $dr_{1-8}$, $th$).
		Waveguides and rings ($r_{1-8}$) are shown as thick grey lines.
		The bigger (purple) highlighted area is a coupling region, shown in \autoref{fig:minimatrix_scheme_zoom}.
	}
	\label{fig:minimatrix_scheme}
\end{figure}

The resonance of each microring is strictly defined by the design of the structure, however it is ultimately changed by imperfections and uncertainties of the manufacturing process.
Hence, since the optical router requires precise positioning of the resonances, their fine tuning is obtained by controlling the temperature of the material.
Each one of the microring resonators in the structure has been manufactured with a thermo-electric heater, which is used to produce the thermo-optic effect (see \autoref{ssec:Thermal_nonlinearities}) in order to induce the required resonance tuning \cite{testa2016design}.
\autoref{fig:minimatrix_scheme_zoom} shows the scheme of the microring resonator geometry, without any non-optical structures (e.g. heaters, metallic contacts).
%This feature has never been exploited in this work, but could come of use in the future.

\begin{figure}[htbp]
	\centering
%	\includegraphics[scale=.4]{figures/single_ring_zoom.png}\\
	\input{tikz/miniMATRIX_scheme_zoom.tex}
	\caption{
	Microring optical cavity region, structures are in scale.
	The ring has an internal radius of $R_{in}=\SI{4.43}{\um}$ and its width is of \SI{0.48}{\um}.
	The waveguides side coupled to the ring have a width of \SI{0.42}{\um} and distance from the ring of \SI{.175}{\um}.
	}
	\label{fig:minimatrix_scheme_zoom}
\end{figure}

\subsection{Initial characterization}
\label{ssec:initial_characterization}
To obtain an initial characterization of the sample, I arranged an experimental setup to measure its fundamental attributes, such as the \acf{FSR}, the \acf{FWHM}, and the $Q$ factor of the resonances.
These features can all be obtained through a study of the transmitted intensity in the through and drop channels, shown in \autoref{fig:minimatrix_scheme}.
A scheme of the experimental setup used is showed in \autoref{fig:simple_setup}.

\begin{figure}
	\centering
	\input{tikz/simple_setup.tex}
	\caption{Scheme of the setup used to obtain an initial characterization of the optical nodes.
		%The source is an external cavity tunable laser that produces a laser beam of up to \SI{8}{\mW} in the range of wavelength required (\SIrange{1500}{1580}{\nm}).
		The source is an external cavity tunable laser that produces a laser beam in the range \SIrange{1500}{1580}{\nm}.
		The second element is an optical circulator and the third is a fiber polarizer.
		After the signal is split into two arms (50\%:50\%): one goes to an \acs{OSA} and is used as reference during the measurements, while the other is fed into the sample.
		Finally the intensity of the signal passed through the node is read by a Germanium \acs{PD} (PD-A).
		}
	\label{fig:simple_setup}
\end{figure}

The laser source used in this measures is an external cavity Yamatsu TUNICS T-100S tunable infrared laser.
It produces a linearly polarized continuous wave laser beam of optical power up to \SI{8}{\mW} in the wavelength range \SIrange{1500}{1580}{\nm}, with a minimum wavelength step of \SI{1}{\pm}.
The generated light is injected into an optical circulator to protect the laser cavity from back-reflections.
A circulator is a device that works similarly to a roundabout: input signals from the first port are directed only toward the second port. Similarly, signals injected in the second port are guided in the third port only and so on.
The circulator used in the setup has four ports.
Afterwards the beam is divided into two equal parts by means of a fiber coupler: one is analyzed by an Anritsu 9710C \ref{} \acf{OSA} and the other is brought to the sample.
The output of the sample is coupled in a fiber and taken to the (PD-A) infrared \ac{PD}

The presence of an \ac{OSA} after the source is due to the fact that the self-referencing mechanism of the laser that occurs during its initialization was not reliable.
In fact, I observed that measures of the resonance taken in different days (after reinitializing the source) showed different values for the resonance.
Hence I analyzed the wavelength emitted from the source with the OSA and observed that
the actual wavelength emitted deviated rather sensibly from the supposed one.
In order to correct this problem, I sampled the supposed-actual wavelength relationship with the \ac{OSA}, and then I implemented an online correction by exploiting the its inverse function.
In doing so, I assumed the \ac{OSA} as a reference.
\autoref{fig:tunics} shows a typical calibration, where the emitted wavelength is greater than the actual one at shorter wavelengths but smaller at longer ones.

\begin{figure}[thbp]
	\centering
	\input{tikz/Tunics.tex}
	\caption{Typical wavelength dependence calibration.
	The black line shows the identity.
	The orange segments in the magnified frames represent the \acs{FWHM} of the resonances.}
	\label{fig:tunics}
\end{figure}

All the structures built on the test chip are accessible via grating couplers and are designed to support modes in the \acs{TE} polarization only.
Grating couplers are planar periodic structures engineered to couple proper light bandwidth from free space into integrated waveguides and vice versa.
In my case, the grating transmission is maximum for wavelengths from \SIrange{1540}{1550}{\nm} and decreases outside.
%This means that even though the PIC could work in a broader range of wavelength, we are limited by the transmission efficiency of each grating.
The coupling loss per grating is almost \SI{5}{\dB} at the maximum transmission, i.e. a third of the signal power is lost at each coupling.

\newpage
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\textwidth]{photos/gg.png}
	\caption{Grating transmission efficiency test structure.}
	\label{fig:grating-grating}
\end{figure}

To properly characterize the coupler transmission, I used a structure manufactured for this purpose.
Depicted in \autoref{fig:grating-grating}, it consists of an input grating coupler, a straight waveguide, and an output grating coupler.
Its transmission efficiency is shown in \autoref{fig:grating}.

%This means that light at wavelength in the predefined range, impinging on the grating coupler with the correct angle, is coupled inside the waveguide on the \ac{PIC}.
%Similarly, light coming from a waveguide to a grating coupler, is radiated as plane wave from the grating coupler with the same mentioned angle.

\begin{figure}[hbtp]
	\centering
	\input{tikz/grating.tex}
	\caption{The maximum transmission efficiency is around \num{0.117} and the coupling loss per grating is almost \SI{5}{\dB}, average over five consecutive measures.}
	\label{fig:grating}
\end{figure}

The sample is adjusted on a 2-\acs{DOF} linear stage in between two 3-\acs{DOF} linear stages that holds the input and output coupling fibers.
\autoref{fig:alignment} shows the respective positions of the input and the output fibers in respect to the grating couplers.

\begin{figure}[!hbtp]
	\centering
	\input{tikz/alignment.tex}
	\caption{Alignment phase of the input and output fibers over the corresponding grating couplers.
	The optical fibers are aligned at an angle of \ang{14} over the grating couplers in such a way to inject and collect as much light as possible.
	The sample was placed in a specific slot of a copper sample holder, which was secured onto a 2-\acs{DOF} manual stage.
	The two fiber holders were placed on a 3-\acs{DOF} manual stage each, to align them properly.
	}
	\label{fig:alignment}
\end{figure}

\newpage
Once secured the input and output optical fibers in place on the linear stages, the alignment phase begins.
First the source light is positioned at a wavelength that transmit on the correct channel, for example the resonance wavelength transmit in the drop channels but not in the through channel and vice versa.
Then the optical fibers are carefully moved in the respective positions that maximize the coupled signal.
The alignment have to be checked periodically, many times a day, to compensate for mechanical relaxations of the setup.
%This procedure needs meticulous practice and method to avoid errors due to noise and imprecise movements of the linear stages.
%Moreover, sometimes the procedure must be repeated even if neither the sample nor the fibers have been moved, because of mechanical relaxation processes of the inner gears.

To obtain the best results, I also designed a new modular fiber holder with fixed angle (\autoref{fig:holders}) that was manufactured twice, one for each fiber. %, that could be used more easily than the older ones with adjustable angle.
The main body has been manufactured in aluminum, except for the actual part that sustains the fiber, which was produced in iron.
The metallic tip of the holder, appropriately grooved to house the optical fiber, can hold still the fiber with the help of little magnets.
This technique aims at reducing as much as possible the vibrations of the fibers ends, which causes fluctuations in the amount of light coupled to the gratings.

\begin{figure}[htbp]
	\centering
	\includegraphics[height=8cm]{figures/supporto_completo.pdf}
	\caption{Exploded-view drawing of the fiber holder design.
	The holder is composed by three pieces.
	The tip is made of iron, in order to be used together with small magnets.}
	\label{fig:holders}
\end{figure}

Since the \acp{PIC} developed for IRIS support \acs{TE} modes only, after the positions of the optical fibers have been optimized, the coupled signal is maximized by the use of a polarizer.
The polarizer, placed between the fiber coupler and the sample, is a device composed by a long optical fiber.
Such fiber is coiled in three separate loops which have the effect of a half-wave plate, one quarter-wave plate, and another half-wave plate respectively.
Each coil can be manipulated, in a similar manner to the bulky quater-/half-wave plates, to change the output (linear) polarization of the light.
%The position of the polarization stage before of after the \ac{OSA} junction is not relevant as the \ac{OSA} is polarization independent.

In order to further reduce the impact of noise on measures, I also boxed the three linear stages with a rigid enclosure.
This decreased the noise, due to the movement of the fiber tips in air by at least one order of magnitude.

For the initial characterization, I studied the response of each output at input signals with low optical power and in the working range of the grating couplers, to identify the position of the resonances and their shape.
%As shown in \autoref{fig:M3sweep}, the through channel $th$ follows the shape of the grating coupler response, which is centered around \SI{1540}{\um} and slowly drops with the growing relative distance from that wavelength.
\autoref{fig:M3sweep} shows the normalized transmission of the eight drop channel ($dr_1$ to $dr_8$ ) and the through channel ($th$).
The first drop channel ($dr_1$) has the expected lorentzian shape, with a free spectral range of $FSR=\SI{19.2+-.1}{\nm}$, while the shapes of all the other drop channels are highly distorted because of the light collected by $dr_1$.
%On the other hand, all the other drop channels show a transmission that is perturbed by the light collected in the first channel.

\begin{figure}[htbp]
	\centering
%	\input{tikz/M1.tex}
%	\input{tikz/M2.tex}
	\input{tikz/M3.tex}
	\caption{
		Transmission spectra of the drop channels ($dr_1$ to $dr_8$) and through channel $th$, average over five consecutive measures.
		The $dr_1$ channel shows the expected shape, whereas the other drop channels are clearly disturbed by the first one.
		The through channel shows a shape similar to the expected one, but it is actually the results of all the drop channels.
	}
	\label{fig:M3sweep}
\end{figure}

Another interesting fact is that the peak transmission of $dr_1$ channel is higher than the maximum transmission of $th$.
This is due to two factors: primarily the coupling maximization process with the linear stages has a repeatability error of about \SI{10}{\percent}, secondarily the $th$ channel is a longer structure and hence its losses are expected to be higher than the 'shorter` $dr_1$ channel.

Since $dr_1$ is the only channel with an unperturbed transmission, I focused my attention on its response only.
Specifically, I studied the resonance near \SI{1551.9}{\um}: % because it was the one with the highest transmitted signal and hence provided a better \acs{SNR}.
\autoref{fig:M3_1550_resonance} shows such resonance and highlights its width to $FWHM=\SI{0.6+-0.05}{\nm}$.
The estimated quality factor is $Q=\num{2600+-200}$.

\begin{figure}[!hbtp]
	\centering
	\input{tikz/M3resonance.tex}
	\caption{
		Resonance at \SI{1551.9}{\nm}, transmission to the drop port $dr_1$, average over five consecutive measures.
%		This spectrum is the only one unperturbed by the other transmission spectra.
%		The FWHM and the resonance wavelength are clearly visible in the figure.
	}
	\label{fig:M3_1550_resonance}
\end{figure}

\section{Characterization of the Activation Function}
\label{sec:Characterization_of_the_Activation_Function}
To characterize the nonlinear response of the microring resonator the setup used for the initial measures has been modified.
To induce the thermal bistability effect in the microring the signal of the TUNICS has been amplified using an \ac{EYDFA}.
%Even more so with the addition of the optical amplifier, the role of the circulator placed between the sources and the rest of the devices is of fundamental importance.
In this configuration, the role of the circulator placed between the sources and the rest of the devices acquires even more importance, as back-reflected signals that enter optical amplifier in the wrong direction can cause serious damage to the equipment.

In addition to the amplifying stage, a remotely controlled \ac{VOA} was added between the polarizer and the sample, to quantitatively characterize the nonlinear response of the microring. %the response of the microring resonator to signals of fixed wavelength but different optical power.
The \ac{VOA} employed is controlled by a voltage signal in the range \SIrange{0}{5}{\V}: it provides full transparency for \SI{0}{\V} and full attenuation for \SI{5}{\V} and, in between, the attenuator behaves similarly to a sigmoid function, shown in \autoref{fig:VOA}.
This curve has been identified with its closest analytical polynomial, to obtain an inverse formula that links transparency values in the range $[0,1]$ to the respective correct voltage value.

\begin{figure}[htbp]
	\centering
	\input{tikz/VOA.tex}
	\caption{Typical calibration curve of the attenuation curve of the VOA.
		The data has been fitted with a spline to implement online control over the attenuation value.
	}
	\label{fig:VOA}
\end{figure}%1.519545

This setup successfully induces the nonlinear response in the microring for detunings up to values comparable to half $FWHM$.
However, instabilities of the source and the amplification stages in the optical power and in the wavelength of the signal increase the uncertainty on the measures.
Specifically, the system shows a drift in optical power immediately after the source and amplification stages are switched on and random noise of the order of \SI{0.1}{\percent}.
Moreover, the wavelength of the light generated shows a slow drift toward shorter wavelengths, which becomes important for long measurements.
The typical wavelength stability of the source is rated at \SI[per-mode=symbol]{+-3}{\pico\meter\per\hour} (from instrument datasheet).

The first corrective measure is obtained by allowing the system to thermalize.
The most critical instrument is the \ac{EYDFA}, which might take up to half an hour to reach a steady state.
This step reduces the slow drift in the output power of the source, but does not suppress the instantaneous noise in power and wavelength of the signal.

In order to provide a correction for the instantaneous noise, a small part of the signal is collected from the main path, before the VOA, via a fiber coupler (99\%:1\%) and it is the equally distributed via a second fiber coupler (50\%:50\%) to the OSA and to a second infrared \ac{PD} (PD-B).
The completed setup is shown in \autoref{fig:pump_setup}.

\begin{figure}[hbtp]
	\centering
	\input{tikz/pump_setup.tex}
	\caption{Scheme of the setup used to obtain characterization of the thermal bistability in the microring resonator.
		The source (TUNICS) is amplified by an \acs{EYDFA} and is followed by the circulator and by the polarizer.
		Then a small part of the signal is collected by a fiber coupler (99\%:1\%) and it is equally distributed between the OSA and an additional infrared \ac{PD} (PD-B).
		The signal in the main path passes through a \acf{VOA}, then it is injected into the sample, and finally extracted to be read by the first \ac{PD} (PD-A).
		}
	\label{fig:pump_setup}
\end{figure}

In this configuration, PD-B measures the instantaneous power in input at the VOA and, together with the value of transparency selected on the VOA, provides control over effective power coupled into the \ac{PIC} and correction over the noise in the power of the source.
The sampling rate of PD-B is the same of PD-A and is limited by the acquisition board (\SI{1}{\kHz}).

On the other hand, the \ac{OSA} provides a check over the wavelength of the source, but no correction can be implemented.
Moreover, the measures obtained by means of the \ac{OSA}, due to intrinsic limitations of the instrument and to the high complexity of the measure itself, have a much lower sampling rate in comparison to the measures given by the \acp{PD}.

Since this setup has been employed to measure several times the hysteresis cycle, for the same input wavelength, the measurement could run for several minutes consecutively.
In order to collect a significant number of points, without important drifts in the signal wavelength, the sampling time had to be reduced as much as possible.
For this reason, the \ac{OSA} has been employed as a check on the signal wavelength, before and after each measure of the hysteresis loops.

%On the other hand, the second infrared detector was inserted in the measuring loops such that it collected data for each sampled point.
To summarize, the data collected is composed by the optical power measured before the \ac{VOA}, by the transparency of the \ac{VOA}, and by the optical power measured at the output.
This three-point measurement allows more robustness against power fluctuations.

%Other than the addition discussed so far, the system setup is very similar to the one used before.
%The coupling system and alignment process of the sample are the same described above in \autoref{ssec:initial_characterization}.

\subsection{Bistability wavelength dependence}
\label{ssec:bistability_wavelength_dependence}
The first feature studied is the dependence of the overall shape of the bistability hysteresis loop on wavelength detuning.
As seen in \autoref{ssec:Simulations}, the form of the bistability changes with the detuning from the resonant wavelength.
This behavior is also observed in the transmission spectra experimentally measured, as shown in \autoref{fig:bistability_shape}.

\begin{figure}[hbtp]
	\centering
	\input{tikz/shapes.tex}
	\caption{Many bistability loops at different wavelengths.
		The loops that are closer to the microring resonance have smaller bistability regions or they have not one at all.
		Loops that are farther from the resonance have larger bistability regions.}
	\label{fig:bistability_shape}
\end{figure}

As expected, the region of bistability disappears into a sigmoid for small detunings, while becomes larger for increased detunings.
The range of wavelengths with which the sample has been probed is upper limited due to the growing pump power required to activate the bistability.

Even though the behavior observed experimentally is similar to the one obtained with the simulations, there are some differences:
first of all, in the experiments the transmission for high input power saturates at the same value for different detunings.
Moreover, in the experiment all wavelengths shows a peak and a decrease in transmission from a certain level of input power.
On the contrary, in the simulations the output power does not saturate and shows different transmission efficiency for each detuning (see \autoref{fig:sim_bist_cycle}).

Several are the factors that might produce these discrepancies between the experiments and the simulations.
First of all, the setup and especially the sample are composed by many different structures.
Each of them has its unique response to high values of optical power.
Secondly, the parameters employed in the simulation are an estimate of the actual parameters that define the microring resonator and its coupling with the waveguides.
Lastly, the theoretical model implemented in the numerical calculations is an approximation of the physical phenomena that occur in the system.

\subsubsection{Bistability region edges}
\label{sssec:bistability_region_edges}
In order to precisely characterize the abrupt jumps on the edges of the bistability region, the stability of the system is crucial.
Hence I implemented a specific series of measurements, which samples only the nearest part of the edge: the amount of points sampled is smaller, however the complete measurement is faster and the sampling near the bistability edges is more dense.

The first step of each measurement is setting the source wavelength at a specific value, which is measured by the \ac{OSA}.
Then the serial measurements begins: for ascending loops, at the beginning \ac{VOA} is initialized at full attenuation and then is used to sample the edge with small increasing steps.
For descending loops, the \ac{VOA} is initialized at full transparency and the steps are decreasing instead.
After the predefined number of loops is completed, the wavelength of the source is measured with the \ac{OSA} again.
%These loops repeatedly initialized the system with the \ac{VOA} at full absorption and then characterized the jump by sampling from few points below to few points above the bistability step.
%Similarly, the other \textit{inverse} bistability step was characterized by analogous loops in which the system was initialized with the VOA at full transparency instead.

The data collected included twenty loops for each detuning, which are five almost equally spaced in a wavelength range from \SIrange{1552.2}{1552.3}{\nm}.
Each set of data has been analyzed to find the abrupt jumps from a state to the other.
A simple study of the discrete derivative was employed to achieve that.
The same procedure has been applied both to the rising as well as to the descending loops.
The results are five data points for the first kind of loops and just as much for the descending one, as shown in \autoref{fig:bistability_jumps}.
The wavelength of each loop is measured by checks with the \acs{OSA} before the start and after the completion of each loop.

\begin{figure}[!hbtp]
	\centering
	\input{tikz/jumps.tex}
	\caption{Wavelength dependence of the bistability region edges.
		Upper limits are shown as blue dots, while lower limits are shown as red dots.
		The wavelength is estimated by checks in betweens consecutive measures obtained with the \acs{OSA}.
		Its uncertainty is assumed to be \SI{5}{\pm} (TUNICS Wavelength Setting Repeatability) for all the points.
		The power uncertainty is given by the statistic of the data collected. % with the loop in power.
	}
	\label{fig:bistability_jumps}
\end{figure}

%The error on each point has been evaluated as follows.
The uncertainty on the wavelength position is assumed to be the \SI{5}{\pm} for all the points, which is the wavelength setting repeatability of the TUNICS.
The uncertainty on the power is evaluated from the statistic of all the loops measured at the same wavelength.
Hence it is defined as the RMS error of twenty data points for each wavelength.

It is interesting to observe that the experimental data, much like the simulations, show a steeper dependence on wavelength for the upper limits that for the lower limits.
Nevertheless, both quantities seem to increase with wavelength more distant from the resonance.
Moreover, the position of the edges of the bistability region seem to be precisely defined by the parameters of the system.

\section{Test of a Trained ANN}
\label{sec:Test_of_a_Trained ANN}
The first step I made to test the nonlinear response of a microring resonator as a neural network activation function was to exploit the fitted bistability curve of \autoref{eq:fit} and implement it as activation function of the model defined in \autoref{ssec:Simulated_ANN_operation}.

\subsection{Optical bistability as nonlinear activation function}
\label{ssec:Optical_bistability_as_nonlinear_activation_function}
Having obtained a description of the optical bistability of the response of a microring resonator in a wide range of wavelengths, I implemented the shape of such response in a simulated artificial neural network.
Hence, I chose a representative set of data:
%from the group, such that it was neither the most distant nor the closest to the resonance.
%This was made to avoid unexpected ``border effects''.
specifically, the data belongs to the increasing half of the bistability loop for input light at \SI{1552.300}{\nm} \ref{}.

\begin{figure}[htbp]
	\centering
	\input{tikz/fit+residuals.tex}
	\caption{Curve fitting and residuals on a set of data.
	The nonlinear curve is the increasing half of a bistability loop.
	The fit is quite close to the original values, except near the jump.}
	\label{fig:fit+residuals}
\end{figure}

The curve employed to fit the data is a combination of function that are already implemented in PyTorch library.
This allows a simple implementation in the simulations.
Specifically the function is composed by \textit{Logistic} and \textit{ReLU} function
\begin{equation}
	f_{fit} \defeq b~f_{Logistic}\left[a(x-x_0)\right] + c~f_{ReLU}\left[x\right]+d~f_{ReLU}\left[x-x_0\right]+e~f_{ReLU}\left[x-x_1\right],
	\label{eq:fit}
\end{equation}
where the parameters $a$, $b$, $c$, $d$, $e$, $x_0$, and $x_1$ are fixed by the fit.

As shown in \autoref{fig:fit+residuals}, the curve fit on the chosen dataset is very close to the original data points.
This is true all over the range of powers, except near the bistability edge, where the maximum difference occurs.

\subsection{Optical bistability vs ReLU and Logistic}
\label{ssec:OBvsReLUvsSIGM}
HO PROVATO DIVERSE GEOMETRIE e DIVERSE LOSS FUNCTIONS\\
COME ADATTARE I PESI VIRTUALI A QUELLI FISICI? rappresentazione a bassa precisione?


\begin{figure}[htbp]
	\centering
	\input{tikz/Train_evolution_OB.tex}
	\caption{Evolution of the loss criterion (solid lines) throughout the epochs.
		Points represent the values of the loss criterion on the validation dataset, carried out repeatedly during the training.
	}
	\label{fig:fit_learning}
\end{figure}

\autoref{fig:fit_learning} shows the evolution of the loss and the validation of each model during the \num{2000} epochs of training.
From the evolution of the loss function we can see that every model has 

The percentage of correct answer of different models that implements the optical bistability activation function is given by \autoref{tab:ExpResults}.
The same shapes have been tested with $f_{ReLU}$ and $f_{Logistic}$ in \autoref{ssec:Simulated_ANN_operation}.

\begin{table}[htbp]
	\centering
	\begin{tabular}{c c c c r}
	\toprule
	activation	& no. hidden 	& no. nodes	& other			& Percent\\
	function		& layers 			& per layer	& parameters	& correct\\
	\midrule
	$f_{fit}$ 			& 2 & 11 & - & \SI{66}{\percent}\\
	$f_{fit}$ 			& 2 & 22 & - & \SI{55}{\percent}\\
	$f_{fit}$ 			& 3 & 11 & - & \SI{44}{\percent}\\
	$f_{fit}$ 			& 3 & 22 & - & \SI{33}{\percent}\\
	\bottomrule
	\end{tabular}
	\caption{Results of the $f_{fit}$ function for several network topologies.
	}
	\label{tab:ExpResults}
\end{table}

As we can see the performance of the $f_{fit}$ function lies in the range of the $f_{ReLU}$, even if a bit lower.
