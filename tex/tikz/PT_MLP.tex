\tikzsetnextfilename{PT_MLP}%	
%	% nodes
%	\foreach \i in {0,1,3} \node (input\i) at (\lin,2.5-\i) [input] {};
	
%	\foreach \j in {\lhid,\lhidb,\lhidd}
%		\foreach \i in {0,1,2,4} \node (inner\j_\i) at (\j,3-\i) [inner] {};
%	\foreach \j in {\lhide}%
%	\foreach \i in {0,1,3} \node (inner\lhide_\i) at (\lhide,2.5-\i) [inner] {};
%	
%	\foreach \i in {0,1,3} \node (output\i) at (\lout,2.5-\i) [output] {};
%	
%	\node (input2)		at (\lin,0.5) {}; 		\node at (\lin,0.6) {$\vdots$};
%	\foreach \j in {\lhid,\lhidb,\lhidd}%
%		\node (inner\j_3)		at (\j,0.0) {};
%	\foreach \j in {\lhid,\lhidb,\lhidd}%
%		\node at (\j,0.1) {$\vdots$};
%	\node (inner\lhide_2) at (\lhide,0.5){}; \node at (\lhide,0.6) {$\vdots$};
%	\node (output2)	at (\lout,0.5) {}; 	\node at (\lout,0.6) {$\vdots$};
	
	% interconnections
	% in - hid1
%	\foreach \i in {0,1,3}%
%		\foreach \j in {0,1,2,4}%
%			\draw [->] (input\i) to [out=0, in=180] (inner\lhid_\j);
%	\foreach \i in {0,1,3}%
%		\draw [dotted, ->] (input\i)	to [out=0, in=180] (inner\lhid_3);
%	\foreach \j in {0,1,2,4}%
%		\draw [dotted, ->] (input2) 	to [out=0, in=180] (inner\lhid_\j);
%	
%	\foreach \i in {0,1,2,4}%
%		\foreach \j in {0,1,2,4}%
%			\draw [->] (inner\lhid_\i) to [out=0, in=180] (inner\lhidb_\j);
%	\foreach \i in {0,1,2,4}%
%		\draw [dotted, ->] (inner\lhid_\i)	to [out=0, in=180] (inner\lhidb_3);
%	\foreach \j in {0,1,2,4}%
%		\draw [dotted, ->] (inner\lhid_3) to [out=0, in=180] (inner\lhidb_\j);
%	
%	\foreach \i in {0,1,2,3,4}%
%		\foreach \j in {0,1,2,3,4}%
%			\draw [dotted,->] (inner\lhidb_\i) to [out=0, in=180] (inner\lhidd_\j);
%	\fill [white] (6.3,-1.5) rectangle (6.7,3.5);
%	\foreach \i in {-0.9,0.1,1.1,2.1,3.1}%
%		\node at (\lhidc,\i) {$\vdots$};
%
%%	\foreach \i in {0,1,3}%
%%		\draw [->] (inner\lhidd_\i) to [out=0, in=180] (output\i);
%	\foreach \i in {0,1,3}%
%		\draw [->] (inner\lhide_\i) to [out=0, in=180] (output\i);
%
%	\draw [dotted, ->] (inner\lhide_2) to [out=0, in=180] (output2);
	
%\end{tikzpicture}

\begin{tikzpicture}
	[%
	input/.style ={isosceles triangle,	draw=red!50,		fill=red!20,		thick,	inner sep=0pt,	minimum size=5mm},%
	inner/.style ={circle,							draw=black!50,	fill=black!20,	thick,	inner sep=0pt,	minimum size=5mm},%
	output/.style={rectangle,					draw=blue!50,	fill=blue!20,	thick,	inner sep=0pt,	minimum size=5mm},%
	]

	\newcommand{\lin}{0}
	\newcommand{\lhid}{2}
	\newcommand{\lhidb}{4}
	\newcommand{\lhidc}{5}
	\newcommand{\lhidd}{6}
	\newcommand{\lhide}{8}
	\newcommand{\lout}{9}
	
	% nodes
	\foreach \i in {0,1,3} \node (input\i) at (\lin,2.5-\i) [input] {};
	
	\foreach \j in {\lhid,\lhidb,\lhidd}%
		\foreach \i in {0,1,2,4} \node (inner\j_\i) at (\j,3-\i) [inner] {};
	\foreach \i in {0,1,3} \node (inner\lhide_\i) at (\lhide,2.5-\i) [inner] {};
	\foreach \i in {0,1,3} \node (output\i) at (\lout,2.5-\i) [output] {};
	
	\node (input2)		at (\lin,0.5) {}; 		\node at (\lin,0.6) {$\vdots$};
	\foreach \j in {\lhid,\lhidb,\lhidd}%
		\node (inner\j_3)		at (\j,0.0) {};
	\foreach \j in {\lhid,\lhidb,\lhidd}%
		\node at (\j,0.1) {$\vdots$};
	\node (inner\lhide_2) at (\lhide,0.5){}; \node at (\lhide,0.6) {$\vdots$};
	\node (output2)	at (\lout,0.5) {}; 	\node at (\lout,0.6) {$\vdots$};
	
	% interconnections
	% in - hid1
	\foreach \i in {0,1,3}%
		\foreach \j in {0,1,2,4}%
			\draw [->] (input\i) to [out=0, in=180] (inner\lhid_\j);
	\foreach \i in {0,1,3}%
		\draw [dotted, ->] (input\i)	to [out=0, in=180] (inner\lhid_3);
	\foreach \j in {0,1,2,4}%
		\draw [dotted, ->] (input2) 	to [out=0, in=180] (inner\lhid_\j);
	
	\foreach \i in {0,1,2,4}%
		\foreach \j in {0,1,2,4}%
			\draw [->] (inner\lhid_\i) to [out=0, in=180] (inner\lhidb_\j);
	\foreach \i in {0,1,2,4}%
		\draw [dotted, ->] (inner\lhid_\i)	to [out=0, in=180] (inner\lhidb_3);
	\foreach \j in {0,1,2,4}%
		\draw [dotted, ->] (inner\lhid_3) to [out=0, in=180] (inner\lhidb_\j);
	
	\foreach \i in {0,1,2,3,4}%
		\foreach \j in {0,1,2,3,4}%
			\draw [dotted,->] (inner\lhidb_\i) to [out=0, in=180] (inner\lhidd_\j);
	\fill [white] (4.8,-1.5) rectangle (5.2,3.5);
	\foreach \i in {-0.9,0.1,1.1,2.1,3.1}%
		\node at (\lhidc,\i) {$\vdots$};
	\foreach \i in {0,1,2,3,4}%
		\draw [dotted, ->] (inner\lhidd_\i)	to [out=0, in=180] (inner\lhide_2);
	\foreach \j in {0,1,2,3}%
		\draw [dotted, ->] (inner\lhidd_3) to [out=0, in=180] (inner\lhide_\j);

	\foreach \i in {0,1,2,4}%
		\foreach \j in {0,1,3}
			\draw [->] (inner\lhidd_\i) to [out=0, in=180] (inner\lhide_\j);
	\foreach \i in {0,1,3}
			\draw [->] (inner\lhide_\i) to [out=0, in=180] (output\i);

	\draw [dotted, ->] (inner\lhide_2) to [out=0, in=180] (output2);
	
	\draw [decorate, decoration={brace, amplitude=5}] (\lhidd,-1.5) -- (\lhid,-1.5)
		node [midway, below=2pt] {$n_{H}\times D_H$};
	\draw [decorate, decoration={brace, amplitude=5}] (-.5,-0.5) -- (-.5,2.5)
		node [midway, left=2pt]  {$D_{in}$};
	\draw [decorate, decoration={brace, amplitude=5}] (9.5,2.5) -- (9.5,-0.5)
		node [midway, right=2pt] {$D_{out}$};
	
\end{tikzpicture}